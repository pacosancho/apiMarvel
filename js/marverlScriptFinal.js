const PRIV_KEY="d965fd4337d81e5090a6273d81059d1e3967451c",PUBLIC_KEY="80643e8d67e791c18c29687ecabda385",maxResultados=40;let delaySearch;function inicializarEventos(){const e=$("option").length;for(let t=0;t<e;t++)$("select").eq(t).change((function(){const e=$("select").val();resetContainers(),""!==e?($("input").val(""),$(".form-group").children("div").show(300),eventInput(e)):$(".form-group").children("div").hide(300)}))}function eventInput(e){$("input").on("input",(function(){clearTimeout(delaySearch);const t=$(this).val();if(resetContainers(),""!==t)switch(e){case"0":delaySearch=setTimeout(()=>{getHeroesResponse(t)},1e3);break;case"1":delaySearch=setTimeout(()=>{getComicsResponse(t)},1e3);break;case"2":delaySearch=setTimeout(()=>{getMarvelResponse(t)},1e3)}}))}function resetContainers(){$("#cardsContainer").children().remove(),$("#pagination").data("twbs-pagination")&&$("#pagination").twbsPagination("destroy")}function getMarvelResponse(e){page=1;const t=(new Date).getTime();$("#overlay").fadeIn(300);let a=`https://gateway.marvel.com/v1/public/characters?limit=${maxResultados}${"&nameStartsWith="+e}`;console.log(a),$.getJSON(a,{ts:t,apikey:PUBLIC_KEY,hash:CryptoJS.MD5(t+PRIV_KEY+PUBLIC_KEY).toString()}).done((function(n){console.log(n),showResults(n.data.results),a=`https://gateway.marvel.com/v1/public/comics?limit=${maxResultados}${"&titleStartsWith="+e}`,console.log(a),$.getJSON(a,{ts:t,apikey:PUBLIC_KEY,hash:CryptoJS.MD5(t+PRIV_KEY+PUBLIC_KEY).toString()}).done((function(e){console.log(e),showResults(e.data.results),e.data.results.length>0&&paginate()})).fail((function(e){console.log(e)})).always((function(){$("#overlay").fadeOut(300)}))})).fail((function(e){$("#cardsContainer").append('<p id="error" class="text-center">Ha ocurrido un error en la busqueda, \n      reintentelo de nuevo o si persiste el problema contacte con el administrador \n      del lugar</p>'),console.log(e)})).always((function(){$("#overlay").fadeOut(300)}))}function getComicsResponse(e){const t=(new Date).getTime(),a=`https://gateway.marvel.com/v1/public/comics?limit=${maxResultados}${"&titleStartsWith="+e}`;page=1,$("#overlay").fadeIn(300),console.log(a),$.getJSON(a,{ts:t,apikey:PUBLIC_KEY,hash:CryptoJS.MD5(t+PRIV_KEY+PUBLIC_KEY).toString()}).done((function(e){console.log(e),showResults(e.data.results),e.data.results.length>0&&paginate()})).fail((function(e){console.log(e),$("#cardsContainer").append('<p id="error" class="text-center">Ha ocurrido un error en la busqueda, \n      reintentelo de nuevo o si persiste el problema contacte con el administrador \n      del lugar</p>')})).always((function(){$("#overlay").fadeOut(300)}))}function getHeroesResponse(e){const t=(new Date).getTime(),a=`https://gateway.marvel.com/v1/public/characters?limit=${maxResultados}${"&nameStartsWith="+e}`;page=1,$("#overlay").fadeIn(300),console.log(a),$.getJSON(a,{ts:t,apikey:PUBLIC_KEY,hash:CryptoJS.MD5(t+PRIV_KEY+PUBLIC_KEY).toString()}).done((function(e){console.log(e),showResults(e.data.results),e.data.results.length>0&&paginate()})).fail((function(e){console.log(e),$("#cardsContainer").append('<p id="error" class="text-center">Ha ocurrido un error en la busqueda, \n      reintentelo de nuevo o si persiste el problema contacte con el administrador \n      del lugar</p>')})).always((function(){$("#overlay").fadeOut(300)}))}addEventListener("load",inicializarEventos,!1);let contRow=0,divRow="",page=1;function showResults(e){contRow=0,divRow="",e.forEach(e=>{let t=createcard(e);if(t=$(t),contRow%4==0||0===contRow){const e=`page${page}`,a=$("<div></div>").addClass("page").attr("id",e);$("#cardsContainer").append(a),(divRow=$('<div class="row justify-content-center"></div>')).append(t),a.append(divRow),page++}else divRow="",$(".row").last().append(t);contRow++;let a="",n="";void 0!==e.title&&(void 0!==e.textObjects[0]&&(n=e.textObjects[0].text),n.length>20&&(a=n.substring(30,n.length),n=n.substring(0,30),$(t).find(".card-text").text(n+"..."),$(t).find(".card-text").append(`<span>${a}</span>`),t.children(".card-body").append('<a class="d-flex justify-content-end" href="#">read more</a>'),$("a").last().prev().children("span").slideToggle(1),$("a").last().click((function(e){e.preventDefault(),"read more"===$(this).text()?$(this).text("read less"):$(this).text("read more"),$(this).prev().children("span").slideToggle(400)}))))})}function createcard(e){let t="";return t=void 0!==e.title?e.title:e.name,`\n  <div class="card col-2 m-4 pt-4">\n    <img class="card-img-top" src="${e.thumbnail.path+"."+e.thumbnail.extension}" alt="Imagen de heroe o comic">\n    <div class="card-body">\n      <h5 class="card-title">${t}</h5>\n      <p class="card-text mb-0"></p>\n    </div>\n  </div>\n  `}function paginate(){$("#pagination").twbsPagination({totalPages:$(".page").length,startPage:1,visiblePages:$(".page").length,initiateStartPageClick:!0,href:!1,hrefVariable:"{{number}}",first:"First",prev:"Previous",next:"Next",last:"Last",loop:!1,onPageClick:function(e,t){$(".page-active").removeClass("page-active"),$("#page"+t).addClass("page-active")},paginationClass:"pagination",nextClass:"next",prevClass:"prev",lastClass:"last",firstClass:"first",pageClass:"page",activeClass:"active",disabledClass:"disabled"})}